# Recipe for version 2.1.26 by Lucas C. Villa Real <lucasvr@gobolinux.org>, on Mon Jan 13 10:30:11 GMT 2014
# Recipe (MakeRecipe) for Cyrus-Sasl by roko, <ro.ko@mcnon.com>, on Wed Dec 8 15:56:58 BRST 2004
compile_version=1.8.4
url="ftp://ftp.cyrusimap.org/cyrus-sasl/cyrus-sasl-2.1.26.tar.gz"
file_size=5220231
file_md5=a7f4e5e559a0e37b3ffc438c9456e425
mirror_url="http://public.www.planetmirror.com/pub/cyrus-mail/cyrus-sasl-2.1.26.tar.gz"
recipe_type=configure
configure_options=(
    --disable-macos-framework  # Not necessary for Mac OS X since we are building inside Rootless
)

environment=(
    # -fPIC will fix a relocation error when building on x86-64
    CFLAGS="$CFLAGS -fPIC"
)

pre_build() {
    rm config/ltconfig config/libtool.m4
    libtoolize -f -c
    aclocal -I config -I cmulocal
    automake -a -c -f
    autoheader
    autoconf -f

    pushd saslauthd
    rm -f config/ltconfig
    libtoolize -f -c
    aclocal -I config -I ../cmulocal -I ../config
    automake -a -c -f
    autoheader
    autoconf -f
    popd
}

pre_install() {
    find plugins/.libs -name "*.la" -exec cp {} {}i \;
}
